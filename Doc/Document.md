# 积分领券APP

## 需求说明

### APP工作流程
![[应用流程]](flow.png)

### 应用界面
1. 启动界面
    加载启动图片(需提供),500ms后进入广告主界面
2. 广告界面(主界面)
    a. 分辨率1080*1920，分割为两部分，上半部分1080*1440，轮播多张图片(小于等于5)或者播放视频(1个)；
        下半部分1080*480，静态展示图片(1张)
    ```
    关联接口：/api/advert/list
    返回数据：
    {
        "name":"xxx广告",
        "id":202012170001,
        "order":1,
        "describe":"xxx会员日活动广告",
        "page":{
            "image":[
                "xxxxxxxxxxxxxxxx",
                "xxxxxxxxxxxxxxxx",
                "xxxxxxxxxxxxxxxx"
            ],
            "videoUrl":"xxxxxxxxxxxxxxxx",
            "type":"img",
            "imageInterval":3
        },
        "banner":{
            "url":"xxxxxxxxxxxxxxxx"
        }
    }
    ```
    广告接口在收到服务端推送或者定时触发(30分钟)

    b. 右上角300*300的区域点击10次进入设置界面

    c. 登录服务端
    ```
    关联接口: (暂未给出)
    ``` 

    d. 推送订阅
    接入t-io SDK接收推送，接收到推送后进入积分领取流程
    推送详细事件类型(暂未给出)

    e. 后台监测人脸
    使用摄像头驱动sdk和人脸识别SDK，应用持续监控拍摄区域内的人脸，当人脸范围到达阈值时进入领券流程

    f. 进程保活
    防止进程被动结束

3. 积分领取界面
    静态展示积分领取页面(需简单UI草图)，点击积分进入人脸识别界面。

4. 人脸识别界面
    界面静态展示圆形预览(参考微信刷脸),捕捉到合适的人脸信息后，发送图片与其他数据到服务端，
    解析服务端返回结果(老用户/新用户)，跳转到接下来的流程。

5. 新用户注册界面
    静态展示服务端返回的二维码，新用户注册使用微信扫描二维码，跳转小程序(需公司开发完成)。同时定时调用服务端接口刷新用户授权状态(1-3秒)。30秒内用户无操作则返回主界面。服务端结果返回后跳转到接下来的流程。

6. 积分领取结果界面
    根据服务端数据展示积分领取结果界面。

7. 优惠券领取界面
    静态展示优惠券页面(需简单UI草图)，点击领券进入人脸识别界面。

8. 优惠券领取结果界面
    根据服务端数据展示优惠券领取结果界面。

9. 设置界面
    静态展示设置列表界面，音量/高级/退出程序。

10. 声音设置界面
    设置系统音量。

11. 高级设置界面
    设置调用服务端参数。

### 全局修改
1. app内置/system/priv-app，使用platform签名，构建脚本(Android.mk)
2. app进程保活白名单
3. app反射调用系统API隐藏底部虚拟按键


